<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏±‡∏î‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏™‡∏≠‡∏ô‡∏Ñ‡∏£‡∏π</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Sarabun:wght@300;400;500;600;700&display=swap');
    body { font-family: 'Sarabun', sans-serif; }
    .timetable-cell { min-height:60px; border:1px solid #e5e7eb; padding:8px; text-align:center; vertical-align:middle; background:white; transition:all .2s; }
    .timetable-cell:hover { background:#f3f4f6; }
    .timetable-cell:focus { outline:2px solid #3b82f6; background:#eff6ff; }
    .day-header { background:linear-gradient(135deg,#3b82f6,#1d4ed8); color:white; font-weight:600; padding:12px; text-align:center; }
    .period-header { background:linear-gradient(135deg,#10b981,#059669); color:white; font-weight:600; padding:12px; text-align:center; writing-mode:vertical-rl; text-orientation:mixed; }
    .info-header { background:linear-gradient(135deg,#9ca3af,#6b7280); color:white; font-weight:600; padding:12px; text-align:center; writing-mode:vertical-rl; text-orientation:mixed; }
    .static-cell { min-height:60px; border:1px solid #e5e7eb; padding:8px; text-align:center; vertical-align:middle; background:#f8fafc; color:#334155; font-style:italic; user-select:none; }
    .tab-button { transition:all .3s ease; }
    .tab-button.active { background:linear-gradient(135deg,#3b82f6,#1d4ed8); color:white; transform:translateY(-2px); box-shadow:0 4px 12px rgba(59,130,246,.3); }
    .gradient-bg{background:linear-gradient(135deg,#667eea 0%,#764ba2 100%);}
    .card-shadow{box-shadow:0 10px 25px rgba(0,0,0,.1);}
    @media print{
      .no-print{display:none!important;}
      @page{size:A4 landscape; margin:1cm;}
      body{font-size:12px;}
      .print-table{width:100%; border-collapse:collapse;}
      .print-table th,.print-table td{border:1px solid #000; padding:4px; text-align:center; vertical-align:middle;}
    }
  </style>
</head>
<body class="bg-gray-50 min-h-screen">
  <!-- Header -->
  <div class="gradient-bg text-white py-6 shadow-lg">
  <div class="container mx-auto px-4">
    <div class="flex flex-col items-center gap-4 sm:flex-row sm:justify-center sm:gap-6">
      
      <!-- ‡πÇ‡∏•‡πÇ‡∏Å‡πâ -->
      <div class="flex-shrink-0">
        <img src="logo.png" alt="‡πÇ‡∏•‡πÇ‡∏Å‡πâ‡πÇ‡∏£‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô" class="w-16 h-16 rounded-full border border-white/30 shadow-md bg-white/10 p-1 object-contain">
      </div>

      <!-- ‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏° -->
      <div class="text-center sm:text-left">
        <h1 class="text-3xl font-bold leading-tight">
          ‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏±‡∏î‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏™‡∏≠‡∏ô‡∏Ñ‡∏£‡∏π
        </h1>
      
        <p class="mt-2 opacity-90 text-sm sm:text-base">
           ‡πÇ‡∏£‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏ö‡πâ‡∏≤‡∏ô‡∏ö‡∏∂‡∏á‡∏Å‡∏≤‡∏¨
        ‡∏™‡∏≥‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô‡πÄ‡∏Ç‡∏ï‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà‡∏Å‡∏≤‡∏£‡∏®‡∏∂‡∏Å‡∏©‡∏≤‡∏õ‡∏£‡∏∞‡∏ñ‡∏°‡∏®‡∏∂‡∏Å‡∏©‡∏≤‡∏ö‡∏∂‡∏á‡∏Å‡∏≤‡∏¨
        </p>

      </div>

    </div>
  </div>
</div>


  <!-- Tabs -->
  <div class="container mx-auto px-4 mt-6">
    <div class="flex space-x-2 bg-white rounded-lg p-2 card-shadow">
      <button id="tab-regular" class="tab-button flex-1 py-3 px-6 rounded-lg font-medium transition-all active">üìÖ ‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏™‡∏≠‡∏ô‡∏õ‡∏£‡∏∞‡∏à‡∏≥</button>
      <button id="tab-substitute" class="tab-button flex-1 py-3 px-6 rounded-lg font-medium transition-all bg-gray-100 hover:bg-gray-200">üîÑ ‡∏à‡∏±‡∏î‡∏™‡∏≠‡∏ô‡πÅ‡∏ó‡∏ô‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ</button>
    </div>
  </div>

  <!-- Regular Timetable -->
  <div id="regular-tab" class="container mx-auto px-4 mt-6">
    <div class="bg-white rounded-lg card-shadow p-6">
      <div class="mb-6">
        <div class="flex flex-wrap gap-3 items-center">
          <div class="flex-1 min-w-64">
            <label class="block text-sm font-medium text-gray-700 mb-2">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏Ñ‡∏£‡∏π</label>
            <select id="teacherSelect" class="w-full px-4 py-2 border border-gray-300 rounded-lg">
              <option value="">-- ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏Ñ‡∏£‡∏π --</option>
            </select>
          </div>

          <!-- ‡∏õ‡∏∏‡πà‡∏°‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏°‡∏∑‡∏≠ -->
          <div class="flex gap-2 items-center">
            <button id="addTeacher" class="bg-green-500 hover:bg-green-600 text-white px-4 py-2 rounded-lg font-medium">
              ‚ûï ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Ñ‡∏£‡∏π‡πÉ‡∏´‡∏°‡πà
            </button>

            <!-- ‡∏õ‡∏∏‡πà‡∏° JSON -->
            <button id="openPasteModal" class="bg-teal-600 hover:bg-teal-700 text-white px-4 py-2 rounded-lg">
              üìù ‡∏ß‡∏≤‡∏á JSON ‡πÄ‡∏≠‡∏á
            </button>
            <button id="importJSON" class="bg-gray-700 hover:bg-gray-800 text-white px-4 py-2 rounded-lg">
              ‚¨ÜÔ∏è ‡πÑ‡∏ü‡∏•‡πå JSON
            </button>
            <input id="jsonFileInput" type="file" accept="application/json" class="hidden">
          </div>
        </div>

        <!-- Modal: Paste JSON -->
        <div id="jsonPasteModal" class="fixed inset-0 bg-black/50 hidden z-50 items-center justify-center p-4">
          <div class="bg-white w-full max-w-3xl rounded-lg shadow-xl">
            <div class="flex items-center justify-between px-4 py-3 border-b">
              <h3 class="font-semibold text-lg">‡∏ß‡∏≤‡∏á JSON ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</h3>
              <button id="closePasteModal" class="text-gray-500 hover:text-gray-700">‚úñ</button>
            </div>
            <div class="p-4">
              <textarea id="jsonPasteInput" class="w-full h-64 border rounded p-3 font-mono text-sm"
                placeholder='‡∏ß‡∏≤‡∏á JSON ‡∏ó‡∏µ‡πà‡∏ô‡∏µ‡πà...'></textarea>
              <div class="mt-3 flex flex-wrap gap-2 justify-end">
                <button id="pasteJSONExample" class="px-3 py-2 rounded border">‡πÉ‡∏™‡πà‡πÇ‡∏Ñ‡∏£‡∏á‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á</button>
                <button id="validateJSONBtn" class="px-3 py-2 rounded bg-amber-500 text-white">‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö JSON</button>
                <button id="importJSONFromTextarea" class="px-3 py-2 rounded bg-teal-600 text-white">‡∏ô‡∏≥‡πÄ‡∏Ç‡πâ‡∏≤</button>
              </div>
              <div id="jsonPasteFeedback" class="mt-2 text-sm"></div>
            </div>
          </div>
        </div>
        <!-- /Modal -->
      </div>

      <div id="teacherNameSection" class="mb-6 hidden">
        <div class="flex gap-4 items-end">
          <div class="flex-1">
            <label class="block text-sm font-medium text-gray-700 mb-2">‡∏ä‡∏∑‡πà‡∏≠‡∏Ñ‡∏£‡∏π</label>
            <input type="text" id="teacherName" class="w-full px-4 py-2 border border-gray-300 rounded-lg">
          </div>
          <button id="saveTeacherName" class="bg-blue-500 hover:bg-blue-600 text-white px-4 py-2 rounded-lg font-medium">
            üíæ ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏ä‡∏∑‡πà‡∏≠
          </button>
        </div>
      </div>

      <div id="timetableSection" class="hidden">
        <div class="mb-4">
          <h3 class="text-lg font-semibold text-gray-800">‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏™‡∏≠‡∏ô</h3>
          <p class="text-sm text-gray-600">‡∏Ñ‡∏≠‡∏•‡∏±‡∏°‡∏ô‡πå ‚Äú‡πÇ‡∏Æ‡∏°‡∏£‡∏π‡∏°‚Äù ‡πÅ‡∏•‡∏∞ ‚Äú‡∏û‡∏±‡∏Å‡∏Å‡∏•‡∏≤‡∏á‡∏ß‡∏±‡∏ô‚Äù ‡πÄ‡∏õ‡πá‡∏ô‡∏Ñ‡∏á‡∏ó‡∏µ‡πà ‡πÑ‡∏°‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏£‡∏≠‡∏Å</p>
        </div>

        <div class="overflow-x-auto">
          <table class="w-full border-collapse border border-gray-300 rounded-lg overflow-hidden">
            <thead>
              <tr>
                <th class="day-header border">‡∏ß‡∏±‡∏ô / ‡∏Ñ‡∏≤‡∏ö</th>
                <th class="info-header border">‡πÇ‡∏Æ‡∏°‡∏£‡∏π‡∏°<br><small>08:00-08:30</small></th>
                <th class="period-header border">‡∏Ñ‡∏≤‡∏ö 1<br><small id="p1Time">08:30-09:30</small></th>
                <th class="period-header border">‡∏Ñ‡∏≤‡∏ö 2<br><small id="p2Time">09:30-10:30</small></th>
                <th class="period-header border">‡∏Ñ‡∏≤‡∏ö 3<br><small id="p3Time">10:30-11:30</small></th>
                <th class="info-header border">‡∏û‡∏±‡∏Å‡∏Å‡∏•‡∏≤‡∏á‡∏ß‡∏±‡∏ô<br><small id="lunchTime">11:30-12:30</small></th>
                <th class="period-header border">‡∏Ñ‡∏≤‡∏ö 4<br><small id="p4Time">12:30-13:30</small></th>
                <th class="period-header border">‡∏Ñ‡∏≤‡∏ö 5<br><small id="p5Time">13:30-14:30</small></th>
                <th class="period-header border">‡∏Ñ‡∏≤‡∏ö 6<br><small id="p6Time">14:30-15:30</small></th>
              </tr>
            </thead>
            <tbody id="timetableGrid"></tbody>
          </table>
        </div>

        <div class="mt-6 flex flex-wrap gap-3">
          <button id="saveGrid" class="bg-blue-500 text-white px-4 py-2 rounded-lg">üíæ ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏™‡∏≠‡∏ô</button>
          <button id="clearGrid" class="bg-yellow-500 text-white px-4 py-2 rounded-lg">üóëÔ∏è ‡∏•‡πâ‡∏≤‡∏á‡∏ó‡∏±‡πâ‡∏á‡∏ï‡∏≤‡∏£‡∏≤‡∏á</button>
          <button id="deleteTeacher" class="bg-red-500 text-white px-4 py-2 rounded-lg">‚ùå ‡∏•‡∏ö‡∏Ñ‡∏£‡∏π‡∏ô‡∏µ‡πâ</button>
        </div>
      </div>
    </div>
  </div>

  <!-- Substitute -->
  <div id="substitute-tab" class="container mx-auto px-4 mt-6 hidden">
    <div class="bg-white rounded-lg card-shadow p-6">
      <div class="grid md:grid-cols-3 gap-6 mb-6">
        <div>
          <label class="block text-sm font-medium text-gray-700 mb-2">‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà</label>
          <input type="date" id="subDate" class="w-full px-4 py-2 border rounded-lg">
        </div>
        <div>
          <label class="block text-sm font-medium text-gray-700 mb-2">‡∏Ñ‡∏£‡∏π‡∏ó‡∏µ‡πà‡πÑ‡∏°‡πà‡∏°‡∏≤‡∏õ‡∏è‡∏¥‡∏ö‡∏±‡∏ï‡∏¥‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏µ‡πà</label>
          <select id="absentTeacher" class="w-full px-4 py-2 border rounded-lg">
            <option value="">-- ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏Ñ‡∏£‡∏π‡∏ó‡∏µ‡πà‡∏Ç‡∏≤‡∏î --</option>
          </select>
        </div>
        <div>
          <label class="block text-sm font-medium text-gray-700 mb-2">‡∏™‡∏≤‡πÄ‡∏´‡∏ï‡∏∏‡∏ó‡∏µ‡πà‡πÑ‡∏°‡πà‡∏°‡∏≤‡∏õ‡∏è‡∏¥‡∏ö‡∏±‡∏ï‡∏¥‡∏£‡∏≤‡∏ä‡∏Å‡∏≤‡∏£</label>
          <input type="text" id="absenceReason" class="w-full px-4 py-2 border rounded-lg" placeholder="‡πÄ‡∏ä‡πà‡∏ô ‡∏≠‡∏ö‡∏£‡∏°/‡∏•‡∏≤‡∏Å‡∏¥‡∏à/‡∏û‡∏≤‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡πÅ‡∏Ç‡πà‡∏á‡∏Ç‡∏±‡∏ô ‡∏Ø‡∏•‡∏Ø">
        </div>
      </div>

      <div class="flex flex-wrap gap-2 mb-6">
        <button id="genSub" class="bg-purple-500 hover:bg-purple-600 text-white px-6 py-3 rounded-lg">üîç ‡πÅ‡∏™‡∏î‡∏á‡∏Ñ‡∏≤‡∏ö‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏™‡∏≠‡∏ô‡πÅ‡∏ó‡∏ô + ‡∏ú‡∏π‡πâ‡∏ß‡πà‡∏≤‡∏á</button>
        <button id="openPrintPage" class="bg-blue-600 hover:bg-blue-700 text-white px-6 py-3 rounded-lg">üñ®Ô∏è ‡πÄ‡∏õ‡∏¥‡∏î‡∏´‡∏ô‡πâ‡∏≤‡∏õ‡∏£‡∏¥‡πâ‡∏ô‡∏ï‡∏≤‡∏°‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà</button>
        <button id="openHistoryPage" class="bg-indigo-600 hover:bg-indigo-700 text-white px-6 py-3 rounded-lg">üìú ‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏£‡∏≤‡∏¢‡∏ß‡∏±‡∏ô</button>
      </div>

      <!-- Tasks -->
      <div id="subTasks" class="hidden mb-6">
        <h3 class="text-lg font-semibold text-gray-800 mb-4">‡∏Ñ‡∏≤‡∏ö‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏´‡∏≤‡∏Ñ‡∏ô‡∏™‡∏≠‡∏ô‡πÅ‡∏ó‡∏ô</h3>
        <div class="overflow-x-auto">
          <table class="w-full border-collapse border rounded-lg overflow-hidden">
            <thead>
              <tr class="bg-gray-50">
                <th class="border px-2 py-2 text-left">‡∏Ñ‡∏≤‡∏ö</th>
                <th class="border px-2 py-2 text-left">‡πÄ‡∏ß‡∏•‡∏≤</th>
                <th class="border px-2 py-2 text-left">‡∏£‡∏≤‡∏¢‡∏ß‡∏¥‡∏ä‡∏≤/‡∏ä‡∏±‡πâ‡∏ô</th>
                <th class="border px-2 py-2 text-left">‡∏Ñ‡∏£‡∏π‡∏ó‡∏µ‡πà‡∏ß‡πà‡∏≤‡∏á / ‡∏°‡∏≠‡∏ö‡∏´‡∏°‡∏≤‡∏¢‡πÅ‡∏•‡πâ‡∏ß</th>
                <th class="border px-2 py-2 text-center">‡∏Å‡∏≤‡∏£‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£</th>
              </tr>
            </thead>
            <tbody id="subTasksBody"></tbody>
          </table>
        </div>
      </div>

      <!-- Summary -->
      <div id="assignmentSummary" class="hidden">
        <div class="flex justify-between items-center mb-4">
          <h3 class="text-lg font-semibold text-gray-800">‡∏™‡∏£‡∏∏‡∏õ‡∏°‡∏≠‡∏ö‡∏´‡∏°‡∏≤‡∏¢‡∏™‡∏≠‡∏ô‡πÅ‡∏ó‡∏ô (‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ)</h3>
          <button id="exportCSV" class="bg-emerald-600 hover:bg-emerald-700 text-white px-4 py-2 rounded-lg no-print">üìä ‡∏™‡πà‡∏á‡∏≠‡∏≠‡∏Å CSV</button>
        </div>
        <div class="overflow-x-auto">
          <table id="assignmentTable" class="w-full border-collapse border rounded-lg overflow-hidden print-table">
            <thead>
              <tr class="bg-gray-50">
                <th class="border px-2 py-2">‡∏Ñ‡∏≤‡∏ö</th>
                <th class="border px-2 py-2">‡πÄ‡∏ß‡∏•‡∏≤</th>
                <th class="border px-2 py-2">‡∏£‡∏≤‡∏¢‡∏ß‡∏¥‡∏ä‡∏≤/‡∏ä‡∏±‡πâ‡∏ô</th>
                <th class="border px-2 py-2">‡∏Ñ‡∏£‡∏π‡∏™‡∏≠‡∏ô‡πÅ‡∏ó‡∏ô</th>
              </tr>
            </thead>
            <tbody id="assignmentBody"></tbody>
          </table>
        </div>
      </div>
    </div>
  </div>

  <!-- App code -->
  <script type="module" src="index.js"></script>
</body>
</html>
